Steps:

  # - Name: Build.StarterRequest
  #   Job: set_static_data
  #   Output: StarterRequest
  #   Params:
  #     data:
  #       - page: 1
  #         pageSize: 20
  #       - page: 2
  #         pageSize: 20

  # - Name: GetToMongo.OpenDatasets
  #   Job: get_data_to_mongo
  #   Output: DiDoDatasets
  #   Input: StarterRequest
  #   Params:
  #     from_worker: openDataConnector
  #     model_name: DiDoDatasetCatalogue


  - Name: Extract.DatafileRids
    Worker: mongoDBConnector
    Job: aggregate_data
    Output: DatafileRids
    Params:
      collection_name: OpenData.DiDo.Datafiles.Summary
      pipeline:
        - $project:
            rid: $datafile_rid
            millesime: 1
        - $unset: 
            - _id 

  - Name: Get.DatafilesByRid
    Job: get_data_to_mongo
    Input: DatafileRids.data
    Output: OpenData.DiDo.Datafiles
    Params:
      from_worker: openDataConnector
      model_name: DiDoDatafiles




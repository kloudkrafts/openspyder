Steps:

  GetRAMUsers:
    Worker: aliyunRAMConnector
    Job: get_data
    Output: RAMUsersList

  StoreRAMUsersToMongo:
    Worker: mongoDBConnector
    Job: insert_dataset
    Output: RAMUsersInsertionResult

  FlattenUserList:
    Worker: mongoDBConnector
    Job: execute_query
    Output: GetAccessKeysInputParams
    Params:
      collection: RAMUsers
      operations:
        $project:
          user_name: $UserName
        $set:
          model: AccessKeys
        $unset:
          - _id

  GetKeysFromUserNames:
    Worker: aliyunRAMConnector
    Job: get_many_data
    Input: 
      - GetAccessKeysInputParams
    Output: RAMUserAccessKeys
    Params:
      model_name: AccessKeys
      user_name: $each.user_name

Steps:

  - Name: GetProjectIds
    Worker: mongoDBConnector
    Job: execute_query
    Output: GCPProjectIds
    Params:
      query_name: GetProjectIds
      query_conf:
        collection: GCPProjects
        operations:
          $project:
            project_id: $project_id
          $unset:
            - _id

  - Name: GetBigQueryProjects
    Worker: gcloudConnector
    Job: get_data
    Output: BigQueryProjects
    Params:
      model_name: BigQueryProjects

  - Name: StoreBigQModels
    Worker: mongoDBConnector
    Job: upsert_dataset
    Input: BigQueryProjects
    Output: BigQueryProjectsInsertionResult
    Params:
      collection: BigQueryProjects

  # - Name: GetBigQueryModels
  #   Worker: gcloudConnector
  #   Job: get_data
  #   Output: BigQueryModels
  #   Input: GCPProjectIds.data
  #   Params:
  #     model_name: BigQueryModels

  # - Name: StoreBigQModels
  #   Worker: mongoDBConnector
  #   Job: upsert_dataset
  #   Input: BigQueryModels
  #   Output: BigQueryModelsInsertionResult
  #   Params:
  #     collection: BigQueryModels

  # - Name: GetGCSBuckets
  #   Worker: gcloudConnector
  #   Job: get_data
  #   Output: GCSBuckets
  #   Input: GCPProjectIds.data
  #   Params:
  #     model_name: GCSBuckets

  # - Name: StoreBucketsToMongo
  #   Worker: mongoDBConnector
  #   Job: upsert_dataset
  #   Input: GCSBuckets
  #   Output: GCSBucketsInsertionResult
  #   Params:
  #     collection: GCSBuckets
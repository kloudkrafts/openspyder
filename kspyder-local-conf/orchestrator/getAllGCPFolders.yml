Steps:

  - Name: GetLevelOneFolders
    Worker: gcloudResourceManagerConnector
    Job: get_data
    Output: L1Folders
    Params:
      model_name: Folders        
      parent: organizations/68618737410

  - Name: GetParentsList
    Job: get_unique_key_list
    Input: L1Folders
    Output: L1FolderIds
    Params:
      key: parent
      datapath: data[].name

  - Name: GetLevelTwoFolders
    Worker: gcloudResourceManagerConnector
    Job: get_data
    Output: L2Folders
    Input: L1FolderIds
    Params:
      model_name: Folders

  # - Name: GetL2ParentsList
  #   Job: get_unique_key_list
  #   Input: L2Folders
  #   Output: L2FolderIds
  #   Params:
  #     key: parent
  #     datapath: data[].name

  # - Name: GetLevelThreeFolders
  #   Worker: gcloudResourceManagerConnector
  #   Job: get_data
  #   Output: L3Folders
  #   Input: L2FolderIds
  #   Params:
  #     model_name: Folders

  - Name: StoreL2FoldersToMongo
    Worker: mongoDBConnector
    Job: insert_dataset
    Input: L2Folders.data
    Output: L2FoldersInsertionResult
    Params:
      collection: GCPFolders